#!/usr/bin/ruby

require 'aip'

raise "package url is required" if ARGV.empty?
url = ARGV[0]

aip = begin
        Aip.new url
      rescue => e
        puts "cannot process #{url}: #{e.message}"
        exit 1
      end

aip.ingest!

if aip.rejected?
  puts "#{aip} is rejected"
  exit 2
elsif aip.snafu?
  puts "#{aip} is snafu"
  exit 3
else
  puts "#{aip} is ingested"
end
